<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
<title>mappingmapp</title>
<style>
li {display:inline;}
.top { padding: 0px; list-style-type: none; display: flex; }
.top li {width: 50px; border: 1px black dotted;}
#MMAPPED li:hover {cursor:hand;}
.editable { height: 25%; }
</style>
<ul class="top" id="LETTERS"></ul>
<ul class="top" id="MMAPPED"></ul>
<div class="editable" id="Words" contenteditable onkeyup="code(this.innerText,mmapped,Code)" onblur="if (this.innerText==='') this.innerText='Type WORDS Here'">Type WORDS Here</div>
<div class="editable" id="Code" contenteditable onkeyup="code(this.innerText,_letters,Words)" onblur="if (this.innerText==='') this.innerText='Type CODE Here'">Type CODE Here</div>
<input style="bottom:0px;right:0px;position:absolute;"type="button" value='reset mapped memory' onclick="localStorage.removeItem('mappingmapp');location.reload();"></input>
<script>
letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
mmapped = location.hash.substring(1).toUpperCase() || localStorage.getItem('mappingmapp') || 'OPQRSTUVWXYZNMABCDEFGHIJKL';
_letters=new Array(letters.length);
numA = 'A'.charCodeAt(0);
numa = 'a'.charCodeAt(0);

code = function toCode(text,mapp,outer) {
	var o="";
	for (var i=0;i<text.length;i++){
		if (/[A-Z]/.test(text[i])) {
			o+=mapp[text.charCodeAt(i)-numA];
		} else if (/[a-z]/.test(text[i])) {
			o+=mapp[text.charCodeAt(i)-numa].toLowerCase();
		} else {
			o+=text[i];
		}
	}
	outer.innerText = o;
}

read = function read() {
	var l="";
	for (var i=0;i<mmapped.length;i++) {
		l += MMAPPED.innerText[2*i];
		_letters[mmapped.charCodeAt(i)-numA] = letters[i];
	}
	mmapped = l;
	localStorage.setItem('mappingmapp',mmapped);
}
// keep variables updated according to the order on page
$('.top').mouseleave(read);

// initialize
LETTERS.innerHTML = ''
MMAPPED.innerHTML = ''
for (var i=0;i<letters.length;i++) {
	LETTERS.innerHTML += '<li>'+letters[i]+'</li>';
	MMAPPED.innerHTML += '<li>'+mmapped[i]+'</li>';
	_letters[mmapped.charCodeAt(i)-numA] = letters[i];
}
$( "#MMAPPED" ).sortable().disableSelection();
</script>